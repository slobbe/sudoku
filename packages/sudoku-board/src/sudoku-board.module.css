.board {
  --_font-family: var(--sudoku-font-family, "Space Grotesk", system-ui, sans-serif);
  --_board-border-color: var(--sudoku-board-border-color, #8a939f);
  --_board-border-width: var(--sudoku-board-border-width, 3px);
  --_board-border-radius: var(--sudoku-board-border-radius, 0);
  --_square-gap: var(--sudoku-square-gap, 2px);
  --_square-divider-color: var(--sudoku-square-divider-color, #b8c0cb);
  --_cell-gap: var(--sudoku-cell-gap, 1px);
  --_cell-bg: var(--sudoku-cell-bg, #f5f7fa);
  --_cell-bg-alt: var(--sudoku-cell-bg-alt, #e9edf3);
  --_cell-ink: var(--sudoku-cell-ink, #1d2630);
  --_cell-font-size: var(--sudoku-cell-font-size, clamp(0.72rem, 5.1cqi, 2.05rem));
  --_cell-font-weight: var(--sudoku-cell-font-weight, 700);
  --_given-bg: var(--sudoku-given-bg, #dfe6f2);
  --_given-ink: var(--sudoku-given-ink, #1b2430);
  --_active-bg: var(--sudoku-active-bg, #cfe0f8);
  --_active-ring: var(--sudoku-active-ring, #5e86c8);
  --_peer-bg: var(--sudoku-peer-bg, #edf2f8);
  --_peer-ring: var(--sudoku-peer-ring, #c3d2e5);
  --_peer-box-bg: var(--sudoku-peer-box-bg, #e7edf5);
  --_peer-box-ring: var(--sudoku-peer-box-ring, #bccbde);
  --_match-bg: var(--sudoku-match-bg, #b9d4ff66);
  --_match-ink: var(--sudoku-match-ink, #10243f);
  --_match-ring: var(--sudoku-match-ring, #5f8fd4);
  --_invalid-ink: var(--sudoku-invalid-ink, #c15454);
  --_focus-ring: var(--sudoku-focus-ring, #4d79bf);
  --_note-ink: var(--sudoku-note-ink, #5c6f85);
  --_note-font-size: var(--sudoku-note-font-size, clamp(0.46rem, 2.2cqi, 0.78rem));
  --_note-font-weight: var(--sudoku-note-font-weight, 600);
  --_note-highlight-ink: var(--sudoku-note-highlight-ink, #17345a);
  --_note-highlight-scale: var(--sudoku-note-highlight-scale, 1.4);
  --_selected-note-ink: var(--sudoku-selected-note-ink, #253245);
  font-family: var(--_font-family);
  width: 100%;
  aspect-ratio: 1 / 1;
  max-width: 100%;
  margin: 0;
  box-sizing: border-box;
  border: var(--_board-border-width) solid var(--_board-border-color);
  border-radius: var(--_board-border-radius);
  overflow: hidden;
  display: grid;
  grid-template-rows: repeat(3, 1fr);
  grid-template-columns: repeat(3, 1fr);
  gap: var(--_square-gap);
  background: var(--_board-border-color);
}

@media (prefers-color-scheme: dark) {
  .board[data-sudoku-color-scheme="auto"] {
    --_board-border-color: var(--sudoku-board-border-color, #5d6773);
    --_square-divider-color: var(--sudoku-square-divider-color, #47505b);
    --_cell-bg: var(--sudoku-cell-bg, #1f2731);
    --_cell-bg-alt: var(--sudoku-cell-bg-alt, #242d38);
    --_cell-ink: var(--sudoku-cell-ink, #d7dee8);
    --_given-bg: var(--sudoku-given-bg, #313b48);
    --_given-ink: var(--sudoku-given-ink, #f0f4fa);
    --_active-bg: var(--sudoku-active-bg, #324960);
    --_active-ring: var(--sudoku-active-ring, #83a5cf);
    --_peer-bg: var(--sudoku-peer-bg, #29333f);
    --_peer-ring: var(--sudoku-peer-ring, #3e4f61);
    --_peer-box-bg: var(--sudoku-peer-box-bg, #27313d);
    --_peer-box-ring: var(--sudoku-peer-box-ring, #3a4a5d);
    --_match-bg: var(--sudoku-match-bg, #7faee633);
    --_match-ink: var(--sudoku-match-ink, #e9f4ff);
    --_match-ring: var(--sudoku-match-ring, #8cb7ea);
    --_invalid-ink: var(--sudoku-invalid-ink, #ff9a9a);
    --_focus-ring: var(--sudoku-focus-ring, #9cc0ea);
    --_note-ink: var(--sudoku-note-ink, #9db0c6);
    --_note-highlight-ink: var(--sudoku-note-highlight-ink, #eef7ff);
    --_selected-note-ink: var(--sudoku-selected-note-ink, #e6edf7);
  }
}

.board[data-sudoku-color-scheme="dark"] {
  --_board-border-color: var(--sudoku-board-border-color, #5d6773);
  --_square-divider-color: var(--sudoku-square-divider-color, #47505b);
  --_cell-bg: var(--sudoku-cell-bg, #1f2731);
  --_cell-bg-alt: var(--sudoku-cell-bg-alt, #242d38);
  --_cell-ink: var(--sudoku-cell-ink, #d7dee8);
  --_given-bg: var(--sudoku-given-bg, #313b48);
  --_given-ink: var(--sudoku-given-ink, #f0f4fa);
  --_active-bg: var(--sudoku-active-bg, #324960);
  --_active-ring: var(--sudoku-active-ring, #83a5cf);
  --_peer-bg: var(--sudoku-peer-bg, #29333f);
  --_peer-ring: var(--sudoku-peer-ring, #3e4f61);
  --_peer-box-bg: var(--sudoku-peer-box-bg, #27313d);
  --_peer-box-ring: var(--sudoku-peer-box-ring, #3a4a5d);
  --_match-bg: var(--sudoku-match-bg, #7faee633);
  --_match-ink: var(--sudoku-match-ink, #e9f4ff);
  --_match-ring: var(--sudoku-match-ring, #8cb7ea);
  --_invalid-ink: var(--sudoku-invalid-ink, #ff9a9a);
  --_focus-ring: var(--sudoku-focus-ring, #9cc0ea);
  --_note-ink: var(--sudoku-note-ink, #9db0c6);
  --_note-highlight-ink: var(--sudoku-note-highlight-ink, #eef7ff);
  --_selected-note-ink: var(--sudoku-selected-note-ink, #e6edf7);
}

.square {
  display: grid;
  grid-template-rows: repeat(3, 1fr);
  grid-template-columns: repeat(3, 1fr);
  gap: var(--_cell-gap);
  background: var(--_square-divider-color);
}

.squareToneA .cell {
  background: var(--_cell-bg);
}

.squareToneB .cell {
  background: var(--_cell-bg-alt);
}

.cell {
  all: unset;
  box-sizing: border-box;
  width: 100%;
  height: 100%;
  border: 0;
  border-radius: 0;
  padding: 0;
  margin: 0;
  color: var(--_cell-ink);
  font-size: var(--_cell-font-size);
  font-weight: var(--_cell-font-weight);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
  touch-action: manipulation;
  cursor: pointer;
  outline: none;
}

.given {
  background: var(--_given-bg);
  color: var(--_given-ink);
}

.peer {
  background: var(--_peer-bg);
  box-shadow: inset 0 0 0 1px var(--_peer-ring);
}

.peerBox {
  background: var(--_peer-box-bg);
  box-shadow: inset 0 0 0 1px var(--_peer-box-ring);
}

.match {
  font-weight: 900;
  color: var(--_match-ink);
  background-image: linear-gradient(var(--_match-bg), var(--_match-bg));
  text-shadow: none;
  box-shadow:
    inset 0 0 0 2px var(--_match-ring),
    inset 0 -3px 0 0 var(--_match-ring);
}

.selected {
  background: var(--_active-bg);
  box-shadow: inset 0 0 0 2px var(--_active-ring);
}

.selected.match {
  box-shadow:
    inset 0 0 0 2px var(--_active-ring),
    inset 0 0 0 4px var(--_match-ring),
    inset 0 -4px 0 0 var(--_match-ring);
}

.invalid {
  color: var(--_invalid-ink);
}

.cell:focus-visible {
  box-shadow:
    inset 0 0 0 2px var(--_focus-ring),
    0 0 0 2px var(--_focus-ring);
}

.notes {
  width: 100%;
  height: 100%;
  padding: 4%;
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  grid-template-rows: repeat(3, 1fr);
  color: var(--_note-ink);
  font-size: var(--_note-font-size);
  font-weight: var(--_note-font-weight);
  line-height: 1;
}

.note {
  display: grid;
  place-items: center;
  transform: scale(1);
  transition: transform 120ms ease;
}

.noteHighlight {
  color: var(--_note-highlight-ink);
  font-weight: 700;
  transform: scale(var(--_note-highlight-scale));
}

.noteEmpty {
  opacity: 0;
}

.selected .notes {
  color: var(--_selected-note-ink);
}
